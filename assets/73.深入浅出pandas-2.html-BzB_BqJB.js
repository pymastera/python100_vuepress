import{_ as s,c as a,a as e,o as t}from"./app-D-bq_jAa.js";const l={};function p(i,n){return t(),a("div",null,n[0]||(n[0]=[e(`<h2 id="深入浅出pandas-2" tabindex="-1"><a class="header-anchor" href="#深入浅出pandas-2"><span>深入浅出pandas-2</span></a></h2><p>如果使用 pandas 做数据分析，那么<code>DataFrame</code>一定是被使用得最多的类型，它可以用来保存和处理异质的二维数据。这里所谓的“异质”是指<code>DataFrame</code>中每个列的数据类型不需要相同，这也是它区别于 NumPy 二维数组的地方。<code>DataFrame</code>提供了极为丰富的属性和方法，帮助我们实现对数据的重塑、清洗、预处理、透视、呈现等一系列操作。</p><h3 id="创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#创建dataframe对象"><span>创建DataFrame对象</span></a></h3><h4 id="通过二维数组创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#通过二维数组创建dataframe对象"><span>通过二维数组创建DataFrame对象</span></a></h4><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">scores <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">courses <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;语文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;数学&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;英语&#39;</span><span class="token punctuation">]</span></span>
<span class="line">stu_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">1006</span><span class="token punctuation">)</span></span>
<span class="line">df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span>scores<span class="token punctuation">,</span> columns<span class="token operator">=</span>courses<span class="token punctuation">,</span> index<span class="token operator">=</span>stu_ids<span class="token punctuation">)</span></span>
<span class="line">df1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">		语文	数学	英语</span>
<span class="line">1001    69    80	79</span>
<span class="line">1002    71	  60	100</span>
<span class="line">1003    94    81	93</span>
<span class="line">1004    88	  88	67</span>
<span class="line">1005    82	  66    60</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="通过字典创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#通过字典创建dataframe对象"><span>通过字典创建DataFrame对象</span></a></h4><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">scores <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;语文&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;数学&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;英语&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">stu_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">1006</span><span class="token punctuation">)</span></span>
<span class="line">df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token operator">=</span>scores<span class="token punctuation">,</span> index<span class="token operator">=</span>stu_ids<span class="token punctuation">)</span></span>
<span class="line">df2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        语文  数学  英语</span>
<span class="line">1001    62    95    66</span>
<span class="line">1002    72    65    75</span>
<span class="line">1003    93    86    82</span>
<span class="line">1004    88    66    69</span>
<span class="line">1005    93    87    82</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="读取csv文件创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#读取csv文件创建dataframe对象"><span>读取CSV文件创建DataFrame对象</span></a></h4><p>可以通过<code>pandas</code> 模块的<code>read_csv</code>函数来读取 CSV 文件，<code>read_csv</code>函数的参数非常多，下面介绍几个比较重要的参数。</p><ul><li><code>sep</code> / <code>delimiter</code>：分隔符，默认是<code>,</code>。</li><li><code>header</code>：表头（列索引）的位置，默认值是<code>infer</code>，用第一行的内容作为表头（列索引）。</li><li><code>index_col</code>：用作行索引（标签）的列。</li><li><code>usecols</code>：需要加载的列，可以使用序号或者列名。</li><li><code>true_values</code> / <code>false_values</code>：哪些值被视为布尔值<code>True</code> / <code>False</code>。</li><li><code>skiprows</code>：通过行号、索引或函数指定需要跳过的行。</li><li><code>skipfooter</code>：要跳过的末尾行数。</li><li><code>nrows</code>：需要读取的行数。</li><li><code>na_values</code>：哪些值被视为空值。</li><li><code>iterator</code>：设置为<code>True</code>，函数返回迭代器对象。</li><li><code>chunksize</code>：配合上面的参数，设置每次迭代获取的数据体量。</li></ul><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;data/2018年北京积分落户数据.csv&#39;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span></span>
<span class="line">df3</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>提示</strong>：上面代码中的CSV文件是用相对路径进行获取的，也就是说当前工作路径下有名为<code>data</code>的文件夹，而“2018年北京积分落户数据.csv”就在这个文件夹下。如果使用Windows系统，在写路径分隔符时也建议使用<code>/</code>而不是<code>\\</code>，如果想使用<code>\\</code>，建议在字符串前面添加一个<code>r</code>，使用原始字符串来避开转义字符，例如<code>r&#39;c:\\new\\data\\2018年北京积分落户数据.csv&#39;</code>。</p></blockquote><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">      name   birthday      company          score</span>
<span class="line">id                                             </span>
<span class="line">1     杨xx   1972-12       北京利德华福xxxx  122.59</span>
<span class="line">2     纪xx   1974-12       北京航天数据xxxx  121.25</span>
<span class="line">3     王x    1974-05       品牌联盟(北京)xx  118.96</span>
<span class="line">4     杨x    1975-07       中科专利商标xxxx  118.21</span>
<span class="line">5     张xx   1974-11       北京阿里巴巴xxxx  117.79</span>
<span class="line">...   ...      ...                  ...     ...</span>
<span class="line">6015  孙xx   1978-08       华为海洋网络xxxx   90.75</span>
<span class="line">6016  刘xx   1976-11       福斯（上海）xxxx   90.75</span>
<span class="line">6017  周x    1977-10       赢创德固赛xxxxxx   90.75</span>
<span class="line">6018  赵x    1979-07       澳科利耳医疗xxxx   90.75</span>
<span class="line">6019  贺x    1981-06       北京宝洁技术xxxx   90.75</span>
<span class="line"></span>
<span class="line">[6019 rows x 4 columns]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>： 上面输出的内容隐去了姓名（name）和公司名称（company）字段中的部分信息。如果需要上面例子中的 CSV 文件，可以通过百度云盘获取，链接：<a href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p></blockquote><h4 id="读取excel工作表创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#读取excel工作表创建dataframe对象"><span>读取Excel工作表创建DataFrame对象</span></a></h4><p>可以通过<code>pandas</code> 模块的<code>read_excel</code>函数来读取 Excel 文件，该函数与上面的<code>read_csv</code>非常类似，多了一个<code>sheet_name</code>参数来指定数据表的名称，但是不同于 CSV 文件，没有<code>sep</code>或<code>delimiter</code>这样的参数。假设有名为“2022年股票数据.xlsx”的 Excel 文件，里面有用股票代码命名的五个表单，分别是阿里巴巴（BABA）、百度（BIDU）、京东（JD）、亚马逊（AMZN）、甲骨文（ORCL）这五个公司2022年的股票数据，如果想加载亚马逊的股票数据，代码如下所示。</p><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df4 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">&#39;data/2022年股票数据.xlsx&#39;</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39;AMZN&#39;</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;Date&#39;</span><span class="token punctuation">)</span></span>
<span class="line">df4</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>：上面例子中的 CSV 文件可以通过百度云盘获取，链接：<a href="https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g" target="_blank" rel="noopener noreferrer">https://pan.baidu.com/s/1rQujl5RQn9R7PadB2Z5g_g</a>，提取码：e7b4。</p></blockquote><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">               Open     High       Low    Close    Volume</span>
<span class="line">Date                                                     </span>
<span class="line">2022-12-30   83.120   84.050   82.4700   84.000  62401194</span>
<span class="line">2022-12-29   82.870   84.550   82.5500   84.180  54995895</span>
<span class="line">2022-12-28   82.800   83.480   81.6900   81.820  58228575</span>
<span class="line">2022-12-27   84.970   85.350   83.0000   83.040  57284035</span>
<span class="line">2022-12-23   83.250   85.780   82.9344   85.250  57433655</span>
<span class="line">...             ...      ...       ...      ...       ...</span>
<span class="line">2022-01-07  163.839  165.243  162.0310  162.554  46605900</span>
<span class="line">2022-01-06  163.450  164.800  161.9370  163.254  51957780</span>
<span class="line">2022-01-05  166.883  167.126  164.3570  164.357  64302720</span>
<span class="line">2022-01-04  170.438  171.400  166.3490  167.522  70725160</span>
<span class="line">2022-01-03  167.550  170.704  166.1600  170.404  63869140</span>
<span class="line"></span>
<span class="line">[251 rows x 5 columns]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="读取关系数据库二维表创建dataframe对象" tabindex="-1"><a class="header-anchor" href="#读取关系数据库二维表创建dataframe对象"><span>读取关系数据库二维表创建DataFrame对象</span></a></h4><p><code>pandas</code>模块的<code>read_sql</code>函数可以通过 SQL 语句从数据库中读取数据创建<code>DataFrame</code>对象，该函数的第二个参数代表了需要连接的数据库。对于 MySQL 数据库，我们可以通过<code>pymysql</code>或<code>mysqlclient</code>来创建数据库连接（需要提前安装好三方库），得到一个<code>Connection</code> 对象，而这个对象就是<code>read_sql</code>函数需要的第二个参数，代码如下所示。</p><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> pymysql</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建一个MySQL数据库的连接对象</span></span>
<span class="line">conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span></span>
<span class="line">    host<span class="token operator">=</span><span class="token string">&#39;101.42.16.8&#39;</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span></span>
<span class="line">    user<span class="token operator">=</span><span class="token string">&#39;guest&#39;</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">&#39;Guest.618&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    database<span class="token operator">=</span><span class="token string">&#39;hrs&#39;</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">&#39;utf8mb4&#39;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 通过SQL从数据库二维表读取数据创建DataFrame</span></span>
<span class="line">df5 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&#39;select * from tb_emp&#39;</span><span class="token punctuation">,</span> conn<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;eno&#39;</span><span class="token punctuation">)</span></span>
<span class="line">df5</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>提示</strong>：执行上面的代码需要先安装<code>pymysql</code>库，如果尚未安装，可以先在单元格中先执行魔法指令<code>%pip install pymysql</code>，然后再运行上面的代码。上面的代码连接的是我部署在腾讯云上的 MySQL 数据库，公网 IP 地址：<code>101.42.16.8</code>，用户名：<code>guest</code>，密码：<code>Guest.618</code>，数据库：<code>hrs</code>，字符集：<code>utf8mb4</code>，大家可以使用这个数据库，但是不要进行恶意的访问。<code>hrs</code>数据库一共有三张表，分别是：<code>tb_dept</code>（部门表）、<code>tb_emp</code>（员工表）、<code>tb_emp2</code>（员工表2）。</p></blockquote><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">       ename   job     mgr     sal    comm    dno</span>
<span class="line">eno                                        </span>
<span class="line">1359   胡一刀   销售员  3344.0  1800   200.0   30</span>
<span class="line">2056    乔峰   分析师   7800.0  5000  1500.0   20</span>
<span class="line">3088   李莫愁   设计师  2056.0  3500   800.0   20</span>
<span class="line">3211   张无忌   程序员  2056.0  3200     NaN   20</span>
<span class="line">3233   丘处机   程序员  2056.0  3400     NaN   20</span>
<span class="line">3244   欧阳锋   程序员  3088.0  3200     NaN   20</span>
<span class="line">3251   张翠山   程序员  2056.0  4000     NaN   20</span>
<span class="line">3344    黄蓉  销售主管  7800.0  3000   800.0   30</span>
<span class="line">3577    杨过    会计    5566.0  2200     NaN   10</span>
<span class="line">3588   朱九真    会计   5566.0  2500     NaN   10</span>
<span class="line">4466   苗人凤   销售员  3344.0  2500     NaN   30</span>
<span class="line">5234    郭靖    出纳    5566.0  2000     NaN   10</span>
<span class="line">5566   宋远桥   会计师  7800.0  4000  1000.0   10</span>
<span class="line">7800   张三丰    总裁     NaN   9000  1200.0   20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行上面的代码会出现一个警告，因为 pandas 库希望我们使用<code>SQLAlchemy</code>三方库接入数据库，具体内容是：“UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.”。如果不想看到这个警告，我们可以试一试下面的解决方案。</p><p>首先，安装三方库<code>SQLAlchemy</code>，在 Jupyter 中可以使用<code>%pip</code>魔法指令。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token operator">%</span>pip install sqlalchemy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过<code>SQLAlchemy</code>的<code>create_engine</code>函数创建<code>Engine</code>对象作为<code>read_sql</code>函数的第二个参数，此时<code>read_sql</code>函数的第一个参数可以是 SQL 语句，也可以是二维表的表名。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 通过指定的URL（统一资源定位符）访问数据库</span></span>
<span class="line">engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">&#39;mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 直接通过表名加载整张表的数据</span></span>
<span class="line">df5 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&#39;tb_emp&#39;</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;eno&#39;</span><span class="token punctuation">)</span></span>
<span class="line">df5</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>：如果通过表名加载二维表数据，也可以将上面的函数换成<code>read_sql_table</code>。</p></blockquote><p>我们再来加载部门表的数据创建<code>DataFrame</code>对象。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">df6 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&#39;select dno, dname, dloc from tb_dept&#39;</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;dno&#39;</span><span class="token punctuation">)</span></span>
<span class="line">df6</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>：如果通过 SQL 查询获取数据，也可以将上面的函数换成<code>read_sql_query</code>。</p></blockquote><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">      dname   dloc</span>
<span class="line">dno           </span>
<span class="line">10    会计部   北京</span>
<span class="line">20    研发部   成都</span>
<span class="line">30    销售部   重庆</span>
<span class="line">40    运维部   深圳</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在完成数据加载后，如果希望释放数据库连接，可以使用下面的代码。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">engine<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="基本属性和方法" tabindex="-1"><a class="header-anchor" href="#基本属性和方法"><span>基本属性和方法</span></a></h3><p>在开始讲解<code>DataFrame</code>的属性和方法前，我们先从之前提到的<code>hrs</code>数据库中读取三张表的数据，创建出三个<code>DataFrame</code>对象，完整的代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">from</span> sqlalchemy <span class="token keyword">import</span> create_engine</span>
<span class="line"></span>
<span class="line">engine <span class="token operator">=</span> create_engine<span class="token punctuation">(</span><span class="token string">&#39;mysql+pymysql://guest:Guest.618@101.42.16.8:3306/hrs&#39;</span><span class="token punctuation">)</span></span>
<span class="line">dept_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql_table<span class="token punctuation">(</span><span class="token string">&#39;tb_dept&#39;</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;dno&#39;</span><span class="token punctuation">)</span></span>
<span class="line">emp_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql_table<span class="token punctuation">(</span><span class="token string">&#39;tb_emp&#39;</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;eno&#39;</span><span class="token punctuation">)</span></span>
<span class="line">emp2_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql_table<span class="token punctuation">(</span><span class="token string">&#39;tb_emp2&#39;</span><span class="token punctuation">,</span> engine<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">&#39;eno&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>得到的三个<code>DataFrame</code>对象如下所示。</p><p>部门表（<code>dept_df</code>），其中<code>dno</code>是部门的编号，<code>dname</code>和<code>dloc</code>分别是部门的名称和所在地。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">    dname  dloc</span>
<span class="line">dno</span>
<span class="line">10	会计部	北京</span>
<span class="line">20	研发部	成都</span>
<span class="line">30	销售部	重庆</span>
<span class="line">40	运维部	深圳</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>员工表（<code>emp_df</code>），其中<code>eno</code>是员工编号，<code>ename</code>、<code>job</code>、<code>mgr</code>、<code>sal</code>、<code>comm</code>和<code>dno</code>分别代表员工的姓名、职位、主管编号、月薪、补贴和部门编号。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        ename    job        mgr      sal     comm    dno</span>
<span class="line">eno</span>
<span class="line">1359	胡一刀    销售员	   3344.0	1800	200.0	30</span>
<span class="line">2056	乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span>
<span class="line">3088	李莫愁	   设计师	   2056.0	3500	800.0	20</span>
<span class="line">3211	张无忌	   程序员	   2056.0	3200	NaN     20</span>
<span class="line">3233	丘处机	   程序员	   2056.0	3400	NaN	    20</span>
<span class="line">3244	欧阳锋	   程序员	   3088.0	3200	NaN     20</span>
<span class="line">3251	张翠山	   程序员	   2056.0	4000	NaN	    20</span>
<span class="line">3344	黄蓉	    销售主管   7800.0	3000	800.0	30</span>
<span class="line">3577	杨过	    会计	     5566.0	  2200	  NaN	  10</span>
<span class="line">3588	朱九真	   会计	    5566.0	 2500	 NaN	 10</span>
<span class="line">4466	苗人凤	   销售员	   3344.0	2500	NaN	    30</span>
<span class="line">5234	郭靖	    出纳	     5566.0	  2000	  NaN	  10</span>
<span class="line">5566	宋远桥	   会计师	   7800.0	4000	1000.0	10</span>
<span class="line">7800	张三丰	   总裁	    NaN      9000	 1200.0	 20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>：在数据库中<code>mgr</code>和<code>comm</code>两个列的数据类型是<code>int</code>，但是因为有缺失值（空值），读取到<code>DataFrame</code>之后，列的数据类型变成了<code>float</code>，因为我们通常会用<code>float</code>类型的<code>NaN</code>来表示空值。</p></blockquote><p>员工表（<code>emp2_df</code>），跟上面的员工表结构相同，但是保存了不同的员工数据。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">       ename    job      mgr      sal    comm    dno</span>
<span class="line">eno                                      </span>
<span class="line">9500   张三丰   总裁      NaN      50000  8000    20</span>
<span class="line">9600   王大锤   程序员    9800.0   8000   600     20</span>
<span class="line">9700   张三丰   总裁      NaN      60000  6000    20</span>
<span class="line">9800   骆昊     架构师    7800.0   30000  5000    20</span>
<span class="line">9900   陈小刀   分析师    9800.0   10000  1200    20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>DataFrame</code>对象的属性如下表所示。</p><table><thead><tr><th>属性名</th><th>说明</th></tr></thead><tbody><tr><td><code>at</code> / <code>iat</code></td><td>通过标签获取<code>DataFrame</code>中的单个值。</td></tr><tr><td><code>columns</code></td><td><code>DataFrame</code>对象列的索引</td></tr><tr><td><code>dtypes</code></td><td><code>DataFrame</code>对象每一列的数据类型</td></tr><tr><td><code>empty</code></td><td><code>DataFrame</code>对象是否为空</td></tr><tr><td><code>loc</code> / <code>iloc</code></td><td>通过标签获取<code>DataFrame</code>中的一组值。</td></tr><tr><td><code>ndim</code></td><td><code>DataFrame</code>对象的维度</td></tr><tr><td><code>shape</code></td><td><code>DataFrame</code>对象的形状（行数和列数）</td></tr><tr><td><code>size</code></td><td><code>DataFrame</code>对象中元素的个数</td></tr><tr><td><code>values</code></td><td><code>DataFrame</code>对象的数据对应的二维数组</td></tr></tbody></table><p>关于<code>DataFrame</code>的方法，首先需要了解的是<code>info()</code>方法，它可以帮助我们了解<code>DataFrame</code>的相关信息，如下所示。</p><p>代码：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="line">Int64Index: 14 entries, 1359 to 7800</span>
<span class="line">Data columns (total 6 columns):</span>
<span class="line"> #   Column  Non-Null Count  Dtype  </span>
<span class="line">---  ------  --------------  -----  </span>
<span class="line"> 0   ename   14 non-null     object </span>
<span class="line"> 1   job     14 non-null     object </span>
<span class="line"> 2   mgr     13 non-null     float64</span>
<span class="line"> 3   sal     14 non-null     int64  </span>
<span class="line"> 4   comm    6 non-null      float64</span>
<span class="line"> 5   dno     14 non-null     int64  </span>
<span class="line">dtypes: float64(2), int64(2), object(2)</span>
<span class="line">memory usage: 1.3+ KB</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果需要查看<code>DataFrame</code>的头部或尾部的数据，可以使用<code>head()</code>或<code>tail()</code>方法，这两个方法的默认参数是<code>5</code>，表示获取<code>DataFrame</code>最前面5行或最后面5行的数据，如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        ename    job    mgr    sal    comm  dno</span>
<span class="line">eno						</span>
<span class="line">1359	胡一刀   销售员	3344   1800  200   30</span>
<span class="line">2056	乔峰	   分析师	 7800   5000  1500	20</span>
<span class="line">3088	李莫愁	  设计师	2056   3500  800   20</span>
<span class="line">3211	张无忌	  程序员	2056   3200  NaN   20</span>
<span class="line">3233	丘处机	  程序员	2056   3400	 NaN   20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="操作数据" tabindex="-1"><a class="header-anchor" href="#操作数据"><span>操作数据</span></a></h3><h4 id="索引和切片" tabindex="-1"><a class="header-anchor" href="#索引和切片"><span>索引和切片</span></a></h4><p>如果要获取<code>DataFrame</code>的某一列，例如取出上面<code>emp_df</code>的<code>ename</code>列，可以使用下面的两种方式。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>ename</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">[</span><span class="token string">&#39;ename&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>执行上面的代码可以发现，我们获得的是一个<code>Series</code>对象。事实上，<code>DataFrame</code>对象就是将多个<code>Series</code>对象组合到一起的结果。</p><p>如果要获取<code>DataFrame</code>的某一行，可以使用整数索引或我们设置的索引，例如取出员工编号为<code>2056</code>的员工数据，代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>通过执行上面的代码我们发现，单独取<code>DataFrame</code> 的某一行或某一列得到的都是<code>Series</code>对象。我们当然也可以通过花式索引来获取多个行或多个列的数据，花式索引的结果仍然是一个<code>DataFrame</code>对象。</p><p>获取多个列：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;ename&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;job&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>获取多个行：</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">,</span> <span class="token number">7800</span><span class="token punctuation">,</span> <span class="token number">3344</span><span class="token punctuation">]</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果要获取或修改<code>DataFrame</code> 对象某个单元格的数据，需要同时指定行和列的索引，例如要获取员工编号为<code>2056</code>的员工的职位信息，代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">[</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;job&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>或者</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">,</span> <span class="token string">&#39;job&#39;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>我们推荐大家使用第三种做法，因为它只做了一次索引运算。如果要将该员工的职位修改为“架构师”，可以使用下面的代码。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">,</span> <span class="token string">&#39;job&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;架构师&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当然，我们也可以通过切片操作来获取多行多列，相信大家一定已经想到了这一点。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2056</span><span class="token punctuation">:</span><span class="token number">3344</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        ename    job        mgr      sal     comm    dno</span>
<span class="line">eno</span>
<span class="line">2056	乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span>
<span class="line">3088	李莫愁	   设计师	   2056.0	3500	800.0	20</span>
<span class="line">3211	张无忌	   程序员	   2056.0	3200	NaN     20</span>
<span class="line">3233	丘处机	   程序员	   2056.0	3400	NaN	    20</span>
<span class="line">3244	欧阳锋	   程序员	   3088.0	3200	NaN     20</span>
<span class="line">3251	张翠山	   程序员	   2056.0	4000	NaN	    20</span>
<span class="line">3344	黄蓉	    销售主管   7800.0	3000	800.0	30</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="数据筛选" tabindex="-1"><a class="header-anchor" href="#数据筛选"><span>数据筛选</span></a></h4><p>上面我们提到了花式索引，相信大家已经联想到了布尔索引。跟<code>ndarray</code>和<code>Series</code>一样，我们可以通过布尔索引对<code>DataFrame</code>对象进行数据筛选，例如我们要从<code>emp_df</code>中筛选出月薪超过<code>3500</code>的员工，代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">[</span>emp_df<span class="token punctuation">.</span>sal <span class="token operator">&gt;</span> <span class="token number">3500</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        ename    job        mgr      sal     comm    dno</span>
<span class="line">eno</span>
<span class="line">2056	乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span>
<span class="line">3251	张翠山	   程序员	   2056.0	4000	NaN	    20</span>
<span class="line">5566	宋远桥	   会计师	   7800.0	4000	1000.0	10</span>
<span class="line">7800	张三丰	   总裁	    NaN      9000	 1200.0	 20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当然，我们也可以组合多个条件来进行数据筛选，例如从<code>emp_df</code>中筛选出月薪超过<code>3500</code>且部门编号为<code>20</code>的员工，代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">[</span><span class="token punctuation">(</span>emp_df<span class="token punctuation">.</span>sal <span class="token operator">&gt;</span> <span class="token number">3500</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>emp_df<span class="token punctuation">.</span>dno <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输出：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">        ename    job        mgr      sal     comm    dno</span>
<span class="line">eno</span>
<span class="line">2056	乔峰	    分析师	    7800.0	 5000	 1500.0	 20</span>
<span class="line">3251	张翠山	   程序员	   2056.0	4000	NaN	    20</span>
<span class="line">7800	张三丰	   总裁	    NaN      9000	 1200.0	 20</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除了使用布尔索引，<code>DataFrame</code>对象的<code>query</code>方法也可以实现数据筛选，<code>query</code>方法的参数是一个字符串，它代表了筛选数据使用的表达式，而且更符合 Python 程序员的使用习惯。下面我们使用<code>query</code>方法将上面的效果重新实现一遍，代码如下所示。</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">emp_df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;sal &gt; 3500 and dno == 20&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,110)]))}const d=s(l,[["render",p],["__file","73.深入浅出pandas-2.html.vue"]]),o=JSON.parse('{"path":"/Day66-80/73.%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BApandas-2.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"深入浅出pandas-2","slug":"深入浅出pandas-2","link":"#深入浅出pandas-2","children":[{"level":3,"title":"创建DataFrame对象","slug":"创建dataframe对象","link":"#创建dataframe对象","children":[]},{"level":3,"title":"基本属性和方法","slug":"基本属性和方法","link":"#基本属性和方法","children":[]},{"level":3,"title":"操作数据","slug":"操作数据","link":"#操作数据","children":[]}]}],"git":{"updatedTime":null,"contributors":[]},"filePathRelative":"Day66-80/73.深入浅出pandas-2.md"}');export{d as comp,o as data};
